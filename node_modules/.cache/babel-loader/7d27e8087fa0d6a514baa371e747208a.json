{"ast":null,"code":"import { Response } from \"miragejs\";\nimport dayjs from \"dayjs\";\nimport jwt_decode from \"jwt-decode\";\nexport const requiresAuth = function (request) {\n  const encodedToken = request.requestHeaders.authorization;\n  const decodedToken = jwt_decode(encodedToken, process.env.REACT_APP_JWT_SECRET);\n\n  if (decodedToken) {\n    const user = this.db.users.findBy({\n      username: decodedToken.username\n    });\n    return user;\n  }\n\n  return new Response(401, {}, {\n    errors: [\"The token is invalid. Unauthorized access error.\"]\n  });\n};\nexport const formatDate = () => dayjs().format(\"YYYY-MM-DDTHH:mm:ssZ\");","map":{"version":3,"names":["Response","dayjs","jwt_decode","requiresAuth","request","encodedToken","requestHeaders","authorization","decodedToken","process","env","REACT_APP_JWT_SECRET","user","db","users","findBy","username","errors","formatDate","format"],"sources":["/Users/naruto/Documents/Github/devgram/src/backend/utils/authUtils.js"],"sourcesContent":["import { Response } from \"miragejs\";\r\nimport dayjs from \"dayjs\";\r\nimport jwt_decode from \"jwt-decode\";\r\n\r\nexport const requiresAuth = function (request) {\r\n  const encodedToken = request.requestHeaders.authorization;\r\n  const decodedToken = jwt_decode(\r\n    encodedToken,\r\n    process.env.REACT_APP_JWT_SECRET\r\n  );\r\n  if (decodedToken) {\r\n    const user = this.db.users.findBy({ username: decodedToken.username });\r\n    return user;\r\n  }\r\n  return new Response(\r\n    401,\r\n    {},\r\n    { errors: [\"The token is invalid. Unauthorized access error.\"] }\r\n  );\r\n};\r\n\r\nexport const formatDate = () => dayjs().format(\"YYYY-MM-DDTHH:mm:ssZ\");\r\n"],"mappings":"AAAA,SAASA,QAAT,QAAyB,UAAzB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,UAAP,MAAuB,YAAvB;AAEA,OAAO,MAAMC,YAAY,GAAG,UAAUC,OAAV,EAAmB;EAC7C,MAAMC,YAAY,GAAGD,OAAO,CAACE,cAAR,CAAuBC,aAA5C;EACA,MAAMC,YAAY,GAAGN,UAAU,CAC7BG,YAD6B,EAE7BI,OAAO,CAACC,GAAR,CAAYC,oBAFiB,CAA/B;;EAIA,IAAIH,YAAJ,EAAkB;IAChB,MAAMI,IAAI,GAAG,KAAKC,EAAL,CAAQC,KAAR,CAAcC,MAAd,CAAqB;MAAEC,QAAQ,EAAER,YAAY,CAACQ;IAAzB,CAArB,CAAb;IACA,OAAOJ,IAAP;EACD;;EACD,OAAO,IAAIZ,QAAJ,CACL,GADK,EAEL,EAFK,EAGL;IAAEiB,MAAM,EAAE,CAAC,kDAAD;EAAV,CAHK,CAAP;AAKD,CAfM;AAiBP,OAAO,MAAMC,UAAU,GAAG,MAAMjB,KAAK,GAAGkB,MAAR,CAAe,sBAAf,CAAzB"},"metadata":{},"sourceType":"module"}